var U=Object.defineProperty,W=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var T=(l,s,a)=>s in l?U(l,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[s]=a,m=(l,s)=>{for(var a in s||(s={}))q.call(s,a)&&T(l,a,s[a]);if(M)for(var a of M(s))G.call(s,a)&&T(l,a,s[a]);return l},u=(l,s)=>W(l,J(s));import{a as K,r as c,u as _,W as Q,j as e,_ as i,o as X,S as Z,s as p,b as v,E as y,B as ee,l as se,I as N,p as te,c as ae,d as ie,$ as ne,b$ as le,aM as oe,ag as re}from"./main-677.js";import{d as de,E as ce,R as L}from"./bf-932-200.js";import{t as R}from"./bf-44-197.js";import{u as me}from"./bf-367-71.js";import{C as ue}from"./bf-149-112.js";import"./bf-647-118.js";import"./bf-648-122.js";import"./bf-102-76.js";import"./bf-610-73.js";function Ne(){const{css:l}=K(),[s,a]=c.useState({sub:"Confirm the submission",body:de,dflt_temp:!0,day:1,custom_redirect:0,acti_succ_msg:"Thanks for the confirmation.",already_activated_msg:"Your mail is already confirmed!",invalid_key_msg:"Sorry! Your URL Is Invalid!"}),F=_(ne),[S,f]=c.useState(!1),[$,k]=c.useState(!1),[h,x]=c.useState(!1),{isPro:z,allPages:w}=F,[B,C]=c.useState(!1),b=_(le),[P,E]=c.useState({show:!1}),I=_(oe),g=Q(re),{isLoading:A,mutate:V}=me("bitforms_get_double_opt_in",{formID:I},{fetchCondition:N,onSuccess:t=>{var o,n;x(Number((o=t[0])==null?void 0:o.status));const r=JSON.parse((n=t[0])==null?void 0:n.integration_details);a(r)}}),D=({target:{name:t,value:r}})=>{a(o=>u(m({},o),{[t]:r})),g(o=>u(m({},o),{unsaved:!0}))},j=({target:{checked:t}},r)=>{const o=se(s);t?o[r]=!0:delete o[r],a(o),g(n=>u(m({},n),{unsaved:!0}))},Y=t=>{N&&(t.target.checked?x(1):x(0),g(r=>u(m({},r),{unsaved:!0})))},H=t=>{if(t.preventDefault(),!N)return;if(s.dflt_temp&&((s==null?void 0:s.fldkey)===void 0||(s==null?void 0:s.fldkey)==="")){E({show:!0,msg:i("Email field is mandatory for double opt-in.")});return}C(!0);const r=te(s,n=>{n.formId=I,n.status=h}),o=ae(r,"bitforms_save_double_opt_in").then(n=>{var O;n!=null&&n.success&&!((O=n==null?void 0:n.data)!=null&&O.errors)&&(C(!1),V(r))});ie.promise(o,{success:i("Saved successfully."),loading:i("Saving..."),error:i("Something went wrong, Try again.")})},d={};return h?(d.opacity=1,d.pointerEvents="auto",d.userSelect="auto"):(d.opacity=.6,d.pointerEvents="none",d.userSelect="none"),e.jsxs("div",{className:"pos-rel",children:[e.jsx("h2",{children:i("Double Opt-In")}),e.jsxs("h5",{children:["How to setup Double Opt-In & Send Email Notification:  ",e.jsx("a",{href:R.doubleOptIn.link,target:"_blank",rel:"noreferrer",className:"yt-txt",children:"YouTube"})," ",e.jsx("a",{href:R.doubleOptInDoc.link,target:"_blank",rel:"noreferrer",className:"doc-txt",children:"Documentation"})]}),!z&&e.jsx("div",{className:"pro-blur flx",style:{height:"111%",left:-53,width:"104%"},children:e.jsxs("div",{className:"pro",children:[i("Available On"),e.jsx("a",{href:"https://www.bitapps.pro/bit-form",target:"_blank",rel:"noreferrer",children:e.jsx("span",{className:"txt-pro",children:i("Premium")})})]})}),A?e.jsx(X,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:70,transform:"scale(0.7)"}}):e.jsxs("div",{children:[e.jsx(Z,{snack:P,setSnackbar:E}),e.jsxs("div",{className:"mt-6 flx",children:[e.jsx("label",{htmlFor:"status",children:e.jsx("b",{children:i("Enable")})}),e.jsx(p,{name:"status",action:Y,checked:h===1,className:"ml-4 flx"})]}),e.jsxs("div",{style:d,children:[e.jsx("br",{}),e.jsxs("div",{className:"flx",children:[e.jsx(p,{name:"auto_unconfirmed_deleted",action:t=>j(t,"auto_unconfirmed_deleted"),checked:"auto_unconfirmed_deleted"in s,className:"flx"}),e.jsx("label",{htmlFor:"auto_unconfirmed_deleted",children:i("Delete the unconfirmed entries from responses after days: ")})," ",e.jsx("input",{onChange:D,name:"day",value:(s==null?void 0:s.day)||1,disabled:!s.auto_unconfirmed_deleted,className:"btcd-paper-inp mr-2 wdt-100",placeholder:"1",type:"number",min:"1"})]}),e.jsxs("div",{className:"mt-2 flx",children:[e.jsx(p,{name:"disable_loggin_user",action:t=>j(t,"disable_loggin_user"),checked:"disable_loggin_user"in s,className:"flx"}),e.jsx("label",{htmlFor:"disable_loggin_user",children:i("Disable double opt-in confirmation for logged in users.")})]}),e.jsxs("div",{className:"mt-4 flx",children:[e.jsx(p,{name:"dflt_temp",action:t=>j(t,"dflt_temp"),checked:!!(s!=null&&s.dflt_temp),className:"flx"}),e.jsx("label",{htmlFor:"dflt_temp",children:i("Configure default confirmation email template")}),e.jsx(ue,{className:"ml-1",icnSize:14,width:600,children:i("By disabling this option, you can configure the double opt-in confirmation email from Conditional Logics manually.")})]}),(s==null?void 0:s.dflt_temp)&&e.jsxs("div",{className:"w-8",children:[e.jsxs("div",{className:"w-5 mt-4",children:[e.jsx("b",{children:"Email"}),e.jsx("br",{}),e.jsxs("select",{className:"btcd-paper-inp mt-1 w-9",name:"fldkey",value:s==null?void 0:s.fldkey,defaultValue:"empty",onChange:D,children:[e.jsx("option",{disabled:!0,value:"empty",children:i("Select Email Field")}),b==null?void 0:b.filter(t=>t.type==="email").map(t=>e.jsx("option",{value:t.key,children:t.name},`${t.key}-1`))]})]}),e.jsxs("div",{className:"flx",children:[e.jsxs("button",{type:"button",className:l(v.btn),onClick:()=>k(!0),children:[e.jsx(y,{size:18})," ",i("Customize Email template")]}),e.jsx(ce,{dataConf:s,setDataConf:a,showMdl:$,setshowMdl:k,title:"Customize Email template"}),(s==null?void 0:s.dflt_temp)&&e.jsxs("div",{className:"ml-2",children:[e.jsxs("button",{type:"button",className:l(v.btn),onClick:()=>f(!0),children:[e.jsx(y,{size:18})," ",i("Edit verification messages")]}),e.jsx(L,{dataConf:s,setDataConf:a,showMdl:S,setCustomRedirectMdl:f,pages:w,title:"Edit verification messages"})]})]})]}),!(s!=null&&s.dflt_temp)&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"mb-0",children:[e.jsx("strong",{children:"Note: "}),e.jsx("span",{children:"Please make sure you have configured the "}),e.jsx("strong",{children:"double opt-in"}),e.jsx("span",{children:" from "}),e.jsx("strong",{children:"conditional logics."}),e.jsx("br",{}),e.jsx("span",{children:"Otherwise, the confirmation message will not sent to the responder."})]}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:l(v.btn),onClick:()=>f(!0),children:[e.jsx(y,{size:18})," ",i("Edit verification messages")]}),e.jsx(L,{dataConf:s,setDataConf:a,showMdl:S,setCustomRedirectMdl:f,pages:w,title:"Show after verification"})]})]})]}),e.jsx("div",{className:"br-5 w-6",children:e.jsxs("p",{className:"mt-0",children:[e.jsx("strong",{children:"Note : "}),"The webhook, email notification & integrations will trigger after the responder confirms their Opt-In."]})}),e.jsx(ee,{onClick:H,disabled:B,children:i("Save ")})]})]})}export{Ne as default};
