var T=Object.defineProperty;var n=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var _=(c,e,s)=>e in c?T(c,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[e]=s,x=(c,e)=>{for(var s in e||(e={}))R.call(e,s)&&_(c,s,e[s]);if(n)for(var s of n(e))$.call(e,s)&&_(c,s,e[s]);return c};import{j as t,T as U,_ as i,u as k,y as M,$ as V,o as O}from"./main-677.js";import{u as S}from"./bf-743-127.js";import{d as q}from"./bf-67-72.js";import{r as I,a as L,b as z}from"./bf-219-377.js";import{S as A}from"./bf-648-122.js";import{M as E}from"./bf-878-130.js";function H({sendinBlueConf:c,setSendinBlueConf:e,setSnackbar:s}){var o;const r=(d,b)=>{const p=x({},c);b==="update"&&(d.target.checked?p.actions.update=!0:delete p.actions.update),b==="double_optin"&&(d.target.checked?(p.actions.double_optin=!0,p.templateId="",p.redirectionUrl="",I(p,e,s)):(delete p.actions.double_optin,delete p.templateId,delete p.redirectionUrl)),e(x({},p))};return t.jsx("div",{className:"pos-rel d-flx w-8",children:t.jsx(U,{checked:((o=c.actions)==null?void 0:o.update)||!1,onChange:d=>r(d,"update"),className:"wdt-200 mt-4 mr-2",value:"user_share",title:i("Update Sendinblue"),subTitle:i("Update Responses with Sendinblue existing email?")})})}function P({i:c,formFields:e,field:s,sendinBlueConf:r,setSendinBlueConf:o}){var v,l,m,N;const d=s.required,b=((v=r==null?void 0:r.default)==null?void 0:v.fields)&&Object.values((l=r==null?void 0:r.default)==null?void 0:l.fields).filter(a=>!a.required),p=k(V),{isPro:g}=p,y=a=>{const h=x({},r);h.field_map.splice(a,0,{}),o(h)},F=a=>{const h=x({},r);h.field_map.length>1&&h.field_map.splice(a,1),o(h)},u=(a,h)=>{const j=x({},r);j.field_map[h][a.target.name]=a.target.value,a.target.value==="custom"&&(j.field_map[h].customValue=""),o(j)},w=(a,h)=>{const j=x({},r);j.field_map[h].customValue=a.target.value,o(j)};return t.jsxs("div",{className:d?"mt-2 mr-1 flx w-9":"flx flx-around mt-2 mr-1",children:[t.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:s.formField||"",onChange:a=>u(a,c),children:[t.jsx("option",{value:"",children:i("Select Field")}),t.jsx("optgroup",{label:"Form Fields",children:e.map(a=>a.type!=="file-up"&&t.jsx("option",{value:a.key,children:a.name},`ff-zhcrm-${a.key}`))}),t.jsx("option",{value:"custom",children:i("Custom...")}),t.jsx("optgroup",{label:`General Smart Codes ${g?"":"(PRO)"}`,children:g&&((m=A)==null?void 0:m.map(a=>t.jsx("option",{value:a.name,children:a.label},`ff-rm-${a.name}`)))})]}),s.formField==="custom"&&t.jsx(E,{onChange:a=>w(a,c),label:i("Custom Value"),className:"mr-2",type:"text",value:s.customValue,placeholder:i("Custom Value")}),t.jsxs("select",{className:"btcd-paper-inp",name:"sendinBlueField",value:s.sendinBlueField,onChange:a=>u(a,c),disabled:d,children:[t.jsx("option",{value:"",children:i("Select Field")}),d?((N=r==null?void 0:r.default)==null?void 0:N.fields)&&Object.values(r.default.fields).map(a=>t.jsx("option",{value:a.fieldId,children:a.fieldName},`${a.fieldId}-1`)):b&&b.map(a=>t.jsx("option",{value:a.fieldId,children:a.fieldName},`${a.fieldId}-1`))]}),!d&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>y(c),className:"icn-btn sh-sm ml-2",type:"button",children:"+"}),t.jsx("button",{onClick:()=>F(c),className:"icn-btn sh-sm ml-2",type:"button","aria-label":"btn",children:t.jsx(M,{})})]})]})}function Y({formFields:c,sendinBlueConf:e,setSendinBlueConf:s,isLoading:r,setisLoading:o,setSnackbar:d,error:b,setError:p}){var u,w,v;const g=l=>{const m=x({},e);l?(m.lists=l?l.split(","):[],!m.default.fields&&z(m,s,o,d)):delete m.lists,s(x({},m))},y=()=>{var l;return(l=e==null?void 0:e.default)!=null&&l.sblueList?Object.values(e.default.sblueList).map(m=>({label:m.name,value:String(m.id)})):[]},F=l=>{const m=x({},e),N=x({},b);N[l.target.name]="",m[l.target.name]=l.target.value,p(N),s(x({},m))};return t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-200 d-in-b",children:i("List: ")}),t.jsx(S,{defaultValue:e==null?void 0:e.lists,className:"btcd-paper-drpdwn w-6",options:y(),onChange:l=>g(l)}),t.jsx("button",{onClick:()=>L(e,s,o,d),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh Sendinblue Lists")}'`},type:"button",disabled:r,children:"↻"})]}),t.jsx("br",{}),t.jsx("br",{}),r&&t.jsx(O,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),((u=e==null?void 0:e.lists)==null?void 0:u.length)!==0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:i("Map Fields")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-1",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:i("Form Fields")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:i("Sendinblue Fields")})})]}),e.field_map.map((l,m)=>t.jsx(P,{i:m,field:l,sendinBlueConf:e,formFields:c,setSendinBlueConf:s},`sendinblue-m-${m+9}`)),t.jsx("div",{className:"txt-center  mt-2",style:{marginRight:85},children:t.jsx("button",{onClick:()=>q(e.field_map.length,e,s),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.jsx("br",{}),t.jsx("br",{}),((w=e.actions)==null?void 0:w.double_optin)&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-150 d-in-b",children:i("Template: ")}),t.jsxs("div",{className:"w-5",children:[t.jsxs("select",{onChange:F,name:"templateId",value:e==null?void 0:e.templateId,className:"btcd-paper-inp",children:[t.jsx("option",{value:"",children:i("Select Template")}),((v=e==null?void 0:e.default)==null?void 0:v.sblueTemplates)&&Object.values(e.default.sblueTemplates).map(l=>t.jsx("option",{value:l.id||e.templateId,children:i(l.name)},`sendinblue-${l.id+2}`))]}),t.jsx("div",{style:{color:"red",fontSize:"15px",marginTop:"3px"},children:b.templateId})]}),t.jsx("button",{onClick:()=>I(e,s,d),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh Sendinblue Templates")}'`},type:"button",disabled:r,children:"↻"})]}),t.jsx("br",{}),t.jsx("br",{}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-150 d-in-b",children:i("RedirectionUrl:")}),t.jsxs("div",{className:"w-5",children:[t.jsx("input",{type:"url",className:"btcd-paper-inp",placeholder:"Redirection URL",onChange:F,value:(e==null?void 0:e.redirectionUrl)||"",name:"redirectionUrl"}),t.jsx("div",{style:{color:"red",fontSize:"15px",marginTop:"3px"},children:b.redirectionUrl})]})]}),t.jsx("br",{}),t.jsx("br",{})]}),t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:i("Actions")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsx(H,{sendinBlueConf:e,setSendinBlueConf:s,setisLoading:o,setSnackbar:d})]})]})}export{Y as S};
