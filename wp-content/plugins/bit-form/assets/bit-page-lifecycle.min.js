var bit_page_lifecycle=function(){"use strict";let e;try{new EventTarget,e=!0}catch(t){e=!1}var t=e?EventTarget:class{constructor(){this.e={}}addEventListener(e,t,s=!1){this.t(e).push(t)}removeEventListener(e,t,s=!1){const i=this.t(e),r=i.indexOf(t);r>-1&&i.splice(r,1)}dispatchEvent(e){return e.target=this,Object.freeze(e),this.t(e.type).forEach((t=>t(e))),!0}t(e){return this.e[e]=this.e[e]||[]}},s=e?Event:class{constructor(e){this.type=e}};class i extends s{constructor(e,t){super(e),this.newState=t.newState,this.oldState=t.oldState,this.originalEvent=t.originalEvent}}const r="active",a="passive",n="hidden",h="frozen",c="terminated",o="object"==typeof safari&&safari.pushNotification,d=["focus","blur","visibilitychange","freeze","resume","pageshow","onpageshow"in self?"pagehide":"unload"],u=e=>(e.preventDefault(),e.returnValue="Are you sure?"),l=[[r,a,n,c],[r,a,n,h],[n,a,r],[h,n],[h,r],[h,a]].map((e=>e.reduce(((e,t,s)=>(e[t]=s,e)),{}))),v=()=>document.visibilityState===n?n:document.hasFocus()?r:a;var f=new class extends t{constructor(){super();const e=v();this.s=e,this.i=[],this.a=this.a.bind(this),d.forEach((e=>addEventListener(e,this.a,!0))),o&&addEventListener("beforeunload",(e=>{this.n=setTimeout((()=>{e.defaultPrevented||e.returnValue.length>0||this.r(e,n)}),0)}))}get state(){return this.s}get pageWasDiscarded(){return document.wasDiscarded||!1}addUnsavedChanges(e){!this.i.indexOf(e)>-1&&(0===this.i.length&&addEventListener("beforeunload",u),this.i.push(e))}removeUnsavedChanges(e){const t=this.i.indexOf(e);t>-1&&(this.i.splice(t,1),0===this.i.length&&removeEventListener("beforeunload",u))}r(e,t){if(t!==this.s){const s=((e,t)=>{for(let s,i=0;s=l[i];++i){const i=s[e],r=s[t];if(i>=0&&r>=0&&r>i)return Object.keys(s).slice(i,r+1)}return[]})(this.s,t);for(let t=0;t<s.length-1;++t){const r=s[t],a=s[t+1];this.s=a,this.dispatchEvent(new i("statechange",{oldState:r,newState:a,originalEvent:e}))}}}a(e){switch(o&&clearTimeout(this.n),e.type){case"pageshow":case"resume":this.r(e,v());break;case"focus":this.r(e,r);break;case"blur":this.s===r&&this.r(e,v());break;case"pagehide":case"unload":this.r(e,e.persisted?h:c);break;case"visibilitychange":this.s!==h&&this.s!==c&&this.r(e,v());break;case"freeze":this.r(e,h)}}};return f}();
