var Y=Object.defineProperty;var z=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var L=(a,i,c)=>i in a?Y(a,i,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[i]=c,m=(a,i)=>{for(var c in i||(i={}))G.call(i,c)&&L(a,c,i[c]);if(z)for(var c of z(i))q.call(i,c)&&L(a,c,i[c]);return a};import{r as F,j as e,T as A,_ as r,M as I,c7 as J,u as K,y as Q,$ as X,o as f}from"./main-677.js";import{h as P,c as D,d as B,e as C}from"./bf-67-72.js";import{u as ee}from"./bf-743-127.js";import{C as M}from"./bf-102-76.js";import{T as ae}from"./bf-680-336.js";import{r as se,a as te,b as re}from"./bf-701-355.js";import{S as le}from"./bf-648-122.js";import{M as ie}from"./bf-878-130.js";function ce({sheetConf:a,setSheetConf:i,formFields:c}){var v,N,p,g,R,S,W,_,T,$,U,E,H,O,V;const[s,d]=F.useState(!1),[x,h]=F.useState({show:!1}),b=(t,o)=>{var k;const n=m({},a);o==="update"&&(t.target.checked&&!((k=n==null?void 0:n.actions)!=null&&k.update)?(n.actions.update={insert:!0,criteria:"",firstMatch:!1},d(!0)):delete n.actions.update),i(m({},n))},j=(t,o,n)=>{var Z;const k=m({},a);(Z=k.actions)!=null&&Z.share||(k.actions.share=[]),k.actions.share[t][o]=n,i(m({},k))},u=(t,o)=>{const n=m({},a);n.actions.update[o]=t,i(m({},n))},w=()=>{var t;if(!((t=a.actions)!=null&&t.update)){const o=m({},a);o.actions.update={insert:!0,criteria:"",firstMatch:!1},i(m({},o))}d(!0)},l=()=>{const t=m({},a);t.actions.share||(t.actions.share=[{email:"",field:"",access:"view",accessLabel:"Read Only"},{email:"",field:"",access:"view_and_comment",accessLabel:"Read/Comment"},{email:"",field:"",access:"edit",accessLabel:"Read/Edit"},{email:"",field:"",access:"share",accessLabel:"Co-Owner"},{email:"",field:"",access:"remove_share",accessLabel:"Remove Share"}]),i(m({},t)),h({show:"share"})},y=()=>{const t=[{title:"Form Fields",type:"group",childs:[]}];return t[0].childs=c.map(o=>({label:o.name,value:`\${${o.key}}`})),t};return F.useEffect(()=>{var t,o;if(!s&&!((o=(t=a.actions)==null?void 0:t.update)!=null&&o.criteria)){const n=m({},a);delete n.actions.update,i(m({},n))}},[s]),e.jsxs("div",{className:"pos-rel",children:[e.jsxs("div",{className:"d-flx flx-wrp",children:[((g=(p=(N=(v=a.default)==null?void 0:v.worksheets)==null?void 0:N.headers)==null?void 0:p[a.worksheet])==null?void 0:g[a.headerRow])&&e.jsx(ae,{action:w,children:e.jsx(A,{onChange:t=>b(t,"update"),checked:"update"in(a==null?void 0:a.actions),className:"wdt-200 mt-4 mr-2",value:"Upsert_Record",title:r("Update Row"),subTitle:r("Control how the row gets updated.")})}),e.jsx(A,{onChange:l,checked:((S=(R=a==null?void 0:a.actions)==null?void 0:R.share)==null?void 0:S.find(t=>t.email))||!1,className:"wdt-200 mt-4 mr-2",value:"user_share",title:r("Share Workbook"),subTitle:r("Share workbook with users pushed to Zoho Sheet.")})]}),e.jsx(I,{md:!0,show:s,setModal:d,title:r("Update Row"),children:e.jsx("div",{className:"o-a",children:((W=a==null?void 0:a.actions)==null?void 0:W.update)&&e.jsxs(e.Fragment,{children:[e.jsx("small",{children:r("Enter the criteria to update rows. Please use the below format.")}),e.jsx("br",{}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("small",{children:["Example: ",'("Month"="March" or "Month"="April") and "Amount">30']}),e.jsx("br",{}),e.jsx("small",{children:"Here Month and Amount are Zoho Sheet's worksheet header name"})," ",e.jsx("span",{className:"icn-btn ml-2 tooltip",style:{"--tooltip-txt":'"Supported Relational Operators: =, !=, <, >, <=, >=, contains"',fontSize:15},children:e.jsx(J,{size:"15"})}),e.jsx("textarea",{name:"",rows:"5",className:"btcd-paper-inp mt-1",onChange:t=>u(t.target.value,"criteria"),value:(T=(_=a.actions)==null?void 0:_.update)==null?void 0:T.criteria})]}),e.jsx("div",{className:"font-w-m mt-3",children:r("Update Preferance")}),e.jsx("small",{children:r("update row for first match only?")}),e.jsxs("div",{children:[e.jsx(M,{onChange:()=>u(!0,"firstMatch"),radio:!0,checked:($=a.actions.update)==null?void 0:$.firstMatch,name:"firstMatch",title:r("Yes")}),e.jsx(M,{onChange:()=>u(!1,"firstMatch"),radio:!0,checked:!((U=a.actions.update)!=null&&U.firstMatch),name:"firstMatch",title:r("No")})]}),e.jsx("small",{children:r("insert new row if the above criteria doesn't met?")}),e.jsxs("div",{children:[e.jsx(M,{onChange:()=>u(!0,"insert"),radio:!0,checked:(E=a.actions.update)==null?void 0:E.insert,name:"up-row",title:r("Yes")}),e.jsx(M,{onChange:()=>u(!1,"insert"),radio:!0,checked:!((H=a.actions.update)!=null&&H.insert),name:"up-row",title:r("No")})]})]})})}),e.jsx(I,{md:!0,show:x.show==="share",setModal:()=>h({show:!1}),title:r("Share Settings"),children:e.jsx("div",{className:"o-a",style:{height:"95%"},children:((V=(O=a==null?void 0:a.actions)==null?void 0:O.share)==null?void 0:V.length)>0&&a.actions.share.map((t,o)=>e.jsxs("div",{className:"flx flx-between mt-2",children:[e.jsx(ee,{className:"btcd-paper-drpdwn w-7 mr-2",placeholder:"Input Email Address(s)",defaultValue:t.email,onChange:n=>j(o,"email",n),options:y(),customValue:!0}),e.jsx("input",{className:"btcd-paper-inp w-3",type:"text",value:t.accessLabel,readOnly:!0})]},t.accessLabel))})})]})}function de({i:a,formFields:i,field:c,sheetConf:s,setSheetConf:d}){var b,j,u,w;const x=K(X),{isPro:h}=x;return e.jsxs("div",{className:"flx mt-2 mr-1",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:c.formField||"",onChange:l=>P(l,a,s,d),children:[e.jsx("option",{value:"",children:r("Select Field")}),e.jsx("optgroup",{label:"Form Fields",children:i.map(l=>l.type!=="file-up"&&e.jsx("option",{value:l.key,children:l.name},`ff-zhcrm-${l.key}`))}),e.jsx("option",{value:"custom",children:r("Custom...")}),e.jsx("optgroup",{label:`General Smart Codes ${h?"":"(PRO)"}`,children:h&&((b=le)==null?void 0:b.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`)))})]}),c.formField==="custom"&&e.jsx(ie,{onChange:l=>D(l,a,s,d),label:r("Custom Value"),className:"mr-2",type:"text",value:c.customValue,placeholder:r("Custom Value")}),e.jsxs("select",{className:"btcd-paper-inp",name:"zohoFormField",value:c.zohoFormField||"",onChange:l=>P(l,a,s,d),children:[e.jsx("option",{value:"",children:r("Select Field")}),((w=(u=(j=s.default.worksheets)==null?void 0:j.headers)==null?void 0:u[s.worksheet])==null?void 0:w[s.headerRow])&&Object.values(s.default.worksheets.headers[s.worksheet][s.headerRow]).map(l=>e.jsx("option",{value:l,children:l},`${l}-1`))]})]}),e.jsx("button",{onClick:()=>B(a,s,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>C(a,s,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx(Q,{})})]})}function we({formID:a,formFields:i,handleInput:c,sheetConf:s,setSheetConf:d,isLoading:x,setisLoading:h,setSnackbar:b}){var j,u,w,l,y,v,N;return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("b",{className:"wdt-150 d-in-b",children:r("Workbook:")}),e.jsxs("select",{onChange:c,name:"workbook",value:s.workbook,className:"btcd-paper-inp w-7",children:[e.jsx("option",{value:"",children:r("Select Workbook")}),((j=s==null?void 0:s.default)==null?void 0:j.workbooks)&&Object.keys(s.default.workbooks).map(p=>e.jsx("option",{value:s.default.workbooks[p].workbookId,children:s.default.workbooks[p].workbookName},p))]}),e.jsx("button",{onClick:()=>se(a,s,d,h,b),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Sheet Workbooks"'},type:"button",disabled:x,children:"↻"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("b",{className:"wdt-150 d-in-b",children:"Worksheet:"}),e.jsxs("select",{onChange:c,name:"worksheet",value:s.worksheet,className:"btcd-paper-inp w-7",children:[e.jsx("option",{value:"",children:r("Select Worksheet")}),((w=(u=s==null?void 0:s.default)==null?void 0:u.worksheets)==null?void 0:w[s.workbook])&&s.default.worksheets[s.workbook].map(p=>e.jsx("option",{value:p,children:p},p))]}),e.jsx("button",{onClick:()=>te(a,s,d,h,b),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Sheet Worksheets"'},type:"button",disabled:x,children:"↻"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("b",{className:"wdt-150 d-in-b",children:r("Header Row:")}),e.jsx("input",{type:"number",min:"1",className:"btcd-paper-inp w-4",placeholder:"Header Row",onChange:c,value:s.headerRow,name:"headerRow"}),e.jsx("button",{onClick:()=>re(a,s,d,h,b),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Worksheet Headers"'},type:"button",disabled:x,children:"↻"}),e.jsx("br",{}),e.jsx("small",{className:"mt-3 d-blk",style:{marginLeft:155,lineHeight:1.8},children:r("By default, first row of the worksheet is considered as header row. This can be used if tabular data starts from any row other than the first row.")}),e.jsx("br",{}),x&&e.jsx(f,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),((N=(v=(y=(l=s.default)==null?void 0:l.worksheets)==null?void 0:y.headers)==null?void 0:v[s.worksheet])==null?void 0:N[s.headerRow])&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:r("Map Fields")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-1",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:r("Form Fields")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:r("Zoho Fields")})})]}),s.field_map.map((p,g)=>e.jsx(de,{i:g,field:p,sheetConf:s,formFields:i,setSheetConf:d},`sheet-m-${g+9}`)),e.jsx("div",{className:"txt-center  mt-2",style:{marginRight:85},children:e.jsx("button",{onClick:()=>B(s.field_map.length,s,d),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{})]}),s.workbook&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:r("Actions")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(ce,{sheetConf:s,setSheetConf:d,formFields:i})]})]})}export{we as Z};
