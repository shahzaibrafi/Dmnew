var Y=Object.defineProperty;var U=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;var z=(e,s,a)=>s in e?Y(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a,x=(e,s)=>{for(var a in s||(s={}))H.call(s,a)&&z(e,a,s[a]);if(U)for(var a of U(s))p.call(s,a)&&z(e,a,s[a]);return e};import{c as R,d as $,_ as c,u as f,j as l,y as h,$ as o,r as K,T as A,n as M,o as P}from"./main-677.js";import{u as V}from"./bf-743-127.js";import{S as b}from"./bf-648-122.js";import{M as C}from"./bf-878-130.js";/* empty css          */const ge=(e,s,a,i)=>{const r=x({},s),{name:d}=e.target;e.target.value!==""?r[d]=e.target.value:delete r[d],a(x({},r))},je=e=>!((e!=null&&e.field_map?e.field_map.filter(a=>!a.formField||!a.hubspotField||!a.formField==="custom"&&!a.customValue):[]).length>0),ee=(e,s)=>{let a=[];s==="contact-create"?a=e==null?void 0:e.contactFields:s==="deal-create"?a=e==null?void 0:e.dealFields:s==="ticket-create"&&(a=e==null?void 0:e.ticketFields);const i=a.filter(r=>r.required===!0);return i.length>0?i.map(r=>({formField:"",hubspotField:r.key})):[{formField:"",hubspotField:""}]},ae=(e,s,a)=>{a(!0);let i="";(e==null?void 0:e.actionName)==="deal-create"?i="deals":i="tickets";const r={apiKey:e.api_key,actionName:i},d=R(r,"bitforms_hubspot_pipeline").then(n=>{if(n&&n.success){const y=x({},e);return y.default||(y.default={}),y.default.pipelines=n.data,s(x({},y)),a(!1),"Pipeline refreshed successfully"}return a(!1),"Pipeline refresh failed. please try again"});$.promise(d,{success:n=>n,error:c("Error Occurred"),loading:c("Loading Pipelines...")})},W=(e,s,a)=>{a(!0);const i={apiKey:e.api_key},r=R(i,"bitforms_hubspot_owners").then(d=>{if(d&&d.success){const n=x({},e);return n.default||(n.default={}),n.default.owners=d.data,s(x({},n)),a(!1),"Owners refreshed successfully"}return a(!1),"Owners refresh failed. please try again"});$.promise(r,{success:d=>d,error:c("Error Occurred"),loading:c("Loading Owners...")})},le=(e,s,a)=>{a(!0);const i={apiKey:e.api_key},r=R(i,"bitforms_hubspot_contacts").then(d=>{if(d&&d.success){const n=x({},e);return n.default||(n.default={}),n.default.contacts=d.data,s(x({},n)),a(!1),"Contacts refreshed successfully"}return a(!1),"Contacts refresh failed. please try again"});$.promise(r,{success:d=>d,error:c("Error Occurred"),loading:c("Loading Contacts...")})},J=(e,s,a)=>{a(!0);const i={apiKey:e.api_key},r=R(i,"bitforms_hubspot_company").then(d=>{if(d&&d.success){const n=x({},e);return n.default||(n.default={}),n.default.companies=d.data,s(x({},n)),a(!1),"Company refreshed successfully"}return a(!1),"Company refresh failed. please try again"});$.promise(r,{success:d=>d,error:c("Error Occurred"),loading:c("Loading Company...")})},X=(e,s,a)=>{const i=x({},s);i.field_map.splice(e,0,{}),a(x({},i))},ce=(e,s,a)=>{const i=x({},s);i.field_map.length>1&&i.field_map.splice(e,1),a(x({},i))},Z=(e,s,a,i)=>{const r=x({},a);r.field_map[s][e.target.name]=e.target.value,e.target.value==="custom"&&(r.field_map[s].customValue=""),i(x({},r))},te=(e,s,a,i)=>{const r=x({},a);r.field_map[s].customValue=e.target.value,i(x({},r))};function ie({i:e,formFields:s,field:a,hubspotConf:i,setHubspotConf:r,actionName:d,hubspotFields:n}){var _,F;if(((_=i==null?void 0:i.field_map)==null?void 0:_.length)===1&&a.hubspotField===""){const m=x({},i),k=ee(m,d);m.field_map=k,r(m)}const y=n.filter(m=>m.required===!0)||[],j=n.filter(m=>m.required===!1)||[],N=f(o),{isPro:w}=N;return l.jsx("div",{className:"flx mt-2 mb-2 bits-field-map",children:l.jsxs("div",{className:"pos-rel flx",children:[l.jsxs("div",{className:"flx integ-fld-wrp",children:[l.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:a.formField||"",onChange:m=>Z(m,e,i,r),children:[l.jsx("option",{value:"",children:c("Select Field")}),l.jsx("optgroup",{label:"Form Fields",children:s==null?void 0:s.map(m=>l.jsx("option",{value:m.key,children:m.name},`ff-rm-${m.key}`))}),l.jsx("option",{value:"custom",children:c("Custom...")}),l.jsx("optgroup",{label:`General Smart Codes ${w?"":"(PRO)"}`,children:w&&((F=b)==null?void 0:F.map(m=>l.jsx("option",{value:m.name,children:m.label},`ff-rm-${m.name}`)))})]}),a.formField==="custom"&&l.jsx(C,{onChange:m=>te(m,e,i,r),label:c("Custom Value"),className:"mr-2",type:"text",value:a.customValue,placeholder:c("Custom Value")}),l.jsxs("select",{className:"btcd-paper-inp",disabled:e<y.length,name:"hubspotField",value:e<(y==null?void 0:y.length)?y[e].key||"":a.hubspotField||"",onChange:m=>Z(m,e,i,r),children:[l.jsx("option",{value:"",children:c("Select Field")}),e<y.length?l.jsx("option",{value:y[e].key,children:y[e].label},y[e].key):j.map(({key:m,label:k})=>l.jsx("option",{value:m,children:k},m))]})]}),e>=y.length&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>X(e,i,r),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),l.jsx("button",{onClick:()=>ce(e,i,r),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:l.jsx(h,{size:"15"})})]})]})})}function se({hubspotConf:e,setHubspotConf:s,formFields:a}){var k,E,I,v,g,S,O,L,q,D,B,G,Q;const[i,r]=K.useState(!1),[d,n]=K.useState({show:!1,action:()=>{}});K.useState({show:!1});const y=(t,T)=>{const u=x({},e);t.target.checked?(T==="contact_owner"?W(e,s,r):T==="company"?J(e,s,r):T==="contact"&&le(e,s,r),u.actions[T]=!0,n({show:T})):(n({show:!1}),delete u.actions[T]),s(x({},u))},j=()=>{n({show:!1})},N=(t,T)=>{const u=x({},e);u[T]=t,s(x({},u))},w=[{value:"subscriber",label:"Subscriber"},{value:"lead",label:"Lead"},{value:"marketingqualifiedlead",label:"Marketing Qualified Lead"},{value:"salesqualifiedlead",label:"Sales Qualified Lead"},{value:"opportunity",label:"Opportunity"},{value:"evangelist",label:"Evangelist"},{value:"other",label:"Other"},{value:"customer",label:"Customer"}],_=[{value:"OPEN",label:"Open"},{value:"NEW",label:"New"},{value:"IN_PROGRESS",label:"In Progress"},{value:"OPEN_DEAL",label:"Open Deal"},{value:"UNQUALIFIED",label:"Unqualified"},{value:"ATTEMPTED_TO_CONTACT",label:"Attempted to contact"},{value:"CONNECTED",label:"Connected"},{value:"BAD_TIMING",label:"Bad timing"}],F=[{value:"newbusiness",label:"New Business"},{value:"existingbusiness",label:"Existing Business"}],m=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}];return l.jsxs("div",{className:"pos-rel d-flx w-8",children:[(e==null?void 0:e.actionName)&&l.jsx(A,{checked:((k=e==null?void 0:e.actions)==null?void 0:k.contact_owner)||!1,onChange:t=>y(t,"contact_owner"),className:"wdt-200 mt-4 mr-2",value:"contact_owner",title:c("Contact Owner"),subTitle:c("Add a contact owner")}),(e==null?void 0:e.actionName)==="contact-create"&&l.jsx(A,{checked:((E=e==null?void 0:e.actions)==null?void 0:E.lifecycle_stage)||!1,onChange:t=>y(t,"lifecycle_stage"),className:"wdt-200 mt-4 mr-2",value:"lifecycle_stage",title:c("Lifecycle Stage"),subTitle:c("Add a lifecycle stage")}),(e==null?void 0:e.actionName)==="contact-create"&&l.jsx(A,{checked:((I=e==null?void 0:e.actions)==null?void 0:I.lead_status)||!1,onChange:t=>y(t,"lead_status"),className:"wdt-200 mt-4 mr-2",value:"lead_status",title:c("Lead Status"),subTitle:c("Add lead status")}),(e==null?void 0:e.actionName)==="deal-create"&&l.jsx(A,{checked:((v=e==null?void 0:e.actions)==null?void 0:v.contact)||!1,onChange:t=>y(t,"contact"),className:"wdt-200 mt-4 mr-2",value:"contact",title:c("Contact"),subTitle:c("Associate deal with contacts")}),(e==null?void 0:e.actionName)==="deal-create"&&l.jsx(A,{checked:((g=e==null?void 0:e.actions)==null?void 0:g.company)||!1,onChange:t=>y(t,"company"),className:"wdt-200 mt-4 mr-2",value:"company",title:c("Company"),subTitle:c("Associate deal with company")}),(e==null?void 0:e.actionName)==="deal-create"&&l.jsx(A,{checked:((S=e==null?void 0:e.actions)==null?void 0:S.deal_type)||!1,onChange:t=>y(t,"deal_type"),className:"wdt-200 mt-4 mr-2",value:"deal_type",title:c("Deal Type"),subTitle:c("Add type to deal")}),(e==null?void 0:e.actionName)!=="contact-create"&&l.jsx(A,{checked:((O=e==null?void 0:e.actions)==null?void 0:O.priority)||!1,onChange:t=>y(t,"priority"),className:"wdt-200 mt-4 mr-2",value:"deal_type",title:c("Priority"),subTitle:c("Add priority to deal")}),l.jsxs(M,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok"),show:d.show==="contact_owner",close:j,action:j,title:c("Contact Owner"),children:[l.jsx("div",{className:"btcd-hr mt-2 mb-2"}),i?l.jsx(P,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):l.jsxs("div",{className:"flx flx-between mt-2",children:[l.jsx(V,{className:"msl-wrp-options",defaultValue:e==null?void 0:e.contact_owner,options:(q=(L=e.default)==null?void 0:L.owners)==null?void 0:q.map(t=>({label:t.ownerName,value:t.ownerId.toString()})),onChange:t=>N(t,"contact_owner"),customValue:!0,singleSelect:!0}),l.jsx("button",{onClick:()=>W(e,s,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${c("Refresh Owners")}'`},type:"button",disabled:i,children:"↻"})]})]}),l.jsxs(M,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok"),show:d.show==="lifecycle_stage",close:j,action:j,title:c("Lifecycle Stage"),children:[l.jsx("div",{className:"btcd-hr mt-2 mb-2"}),i?l.jsx(P,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):l.jsx("div",{className:"flx flx-between mt-2",children:l.jsx(V,{className:"msl-wrp-options",defaultValue:e==null?void 0:e.lifecycle_stage,options:w==null?void 0:w.map(t=>({label:t.label,value:t.value.toString()})),onChange:t=>N(t,"lifecycle_stage"),customValue:!0,singleSelect:!0})})]}),l.jsxs(M,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok"),show:d.show==="lead_status",close:j,action:j,title:c("Lead Status"),children:[l.jsx("div",{className:"btcd-hr mt-2 mb-2"}),i?l.jsx(P,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):l.jsx("div",{className:"flx flx-between mt-2",children:l.jsx(V,{className:"msl-wrp-options",defaultValue:e==null?void 0:e.lead_status,options:_==null?void 0:_.map(t=>({label:t.label,value:t.value.toString()})),onChange:t=>N(t,"lead_status"),customValue:!0,singleSelect:!0})})]}),l.jsxs(M,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok"),show:d.show==="contact",close:j,action:j,title:c("Contacts"),children:[l.jsx("div",{className:"btcd-hr mt-2 mb-2"}),i?l.jsx(P,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):l.jsx("div",{className:"flx flx-between mt-2",children:l.jsx(V,{className:"msl-wrp-options",defaultValue:e==null?void 0:e.contact,options:(B=(D=e==null?void 0:e.default)==null?void 0:D.contacts)==null?void 0:B.map(t=>({label:t.contactName,value:t.contactId.toString()})),onChange:t=>N(t,"contact"),customValue:!0,singleSelect:!0})})]}),l.jsxs(M,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok"),show:d.show==="company",close:j,action:j,title:c("Company"),children:[l.jsx("div",{className:"btcd-hr mt-2 mb-2"}),i?l.jsx(P,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):l.jsxs("div",{className:"flx flx-between mt-2",children:[l.jsx(V,{className:"msl-wrp-options",defaultValue:e==null?void 0:e.company,options:(Q=(G=e==null?void 0:e.default)==null?void 0:G.companies)==null?void 0:Q.map(t=>({label:t.companyName,value:t.companyId.toString()})),onChange:t=>N(t,"company"),customValue:!0,singleSelect:!0}),l.jsx("button",{onClick:()=>J(e,s,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${c("Refresh CRM Tags")}'`},type:"button",disabled:i,children:"↻"})]})]}),l.jsxs(M,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok"),show:d.show==="deal_type",close:j,action:j,title:c("Deal Type"),children:[l.jsx("div",{className:"btcd-hr mt-2 mb-2"}),i?l.jsx(P,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):l.jsx("div",{className:"flx flx-between mt-2",children:l.jsx(V,{className:"msl-wrp-options",defaultValue:e==null?void 0:e.deal_type,options:F==null?void 0:F.map(t=>({label:t.label,value:t.value.toString()})),onChange:t=>N(t,"deal_type"),customValue:!0,singleSelect:!0})})]}),l.jsxs(M,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok"),show:d.show==="priority",close:j,action:j,title:c("Priority"),children:[l.jsx("div",{className:"btcd-hr mt-2 mb-2"}),i?l.jsx(P,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):l.jsx("div",{className:"flx flx-between mt-2",children:l.jsx(V,{className:"msl-wrp-options",defaultValue:e==null?void 0:e.priority,options:m==null?void 0:m.map(t=>({label:t.label,value:t.value.toString()})),onChange:t=>N(t,"priority"),customValue:!0,singleSelect:!0})})]})]})}function ve({formFields:e,handleInput:s,hubspotConf:a,setHubspotConf:i,isLoading:r,setIsLoading:d,setSnackbar:n}){var k,E,I;const y=[{key:"email",label:"Email",required:!0},{key:"firstname",label:"First Name",required:!1},{key:"lastname",label:"Last Name",required:!1},{key:"website",label:"Website",required:!1},{key:"company",label:"Company",required:!1},{key:"phone",label:"Phone",required:!1},{key:"address",label:"Address",required:!1},{key:"city",label:"City",required:!1},{key:"state",label:"State",required:!1},{key:"zip",label:"Zip",required:!1},{key:"jobtitle",label:"Job Title",required:!1}],j=[{key:"dealname",label:"Deal Name",required:!0},{key:"amount",label:"Amount",required:!1},{key:"closedate",label:"Close Date",required:!1}],N=[{key:"subject",label:"Ticket Name",required:!0},{key:"content",label:"Ticket description",required:!1}];let w=[];const _=[{label:"Contact Create",value:"contact-create"},{label:"Deal Create",value:"deal-create"},{label:"Ticket Create",value:"ticket-create"}],F=v=>{let g=[];return(a==null?void 0:a.actionName)==="contact-create"?g=(a==null?void 0:a.contactFields)||[]:(a==null?void 0:a.actionName)==="deal-create"?g=(a==null?void 0:a.dealFields)||[]:(a==null?void 0:a.actionName)==="ticket-create"&&(g=(a==null?void 0:a.ticketFields)||[]),g},m=v=>{var L;const g=x({},a),{name:S,value:O}=v.target;if(v.target.value!==""?g[S]=v.target.value:delete g[S],S==="pipeline")w=(L=a==null?void 0:a.default)==null?void 0:L.pipelines.filter(({pipelineId:q})=>q===O).map(({stages:q})=>q),g.stageTmp=w,i(x({},g));else if(S==="actionName"){const D={name:"Hubspot",type:"Hubspot",api_key:a==null?void 0:a.api_key,field_map:[{formField:"",hubspotField:""}],actionName:O,actions:{},contactFields:y,dealFields:j,ticketFields:N};O==="deal-create"||O==="ticket-create"?ae(D,i,d):i(D)}};return l.jsxs(l.Fragment,{children:[l.jsx("br",{}),l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:c("Action:")}),l.jsxs("select",{onChange:m,name:"actionName",value:a==null?void 0:a.actionName,className:"btcd-paper-inp w-5",children:[l.jsx("option",{value:"",children:c("Select Action")}),_.map(({label:v,value:g})=>l.jsx("option",{value:g,children:v},v))]})]}),l.jsx("br",{}),l.jsx("br",{}),((a==null?void 0:a.actionName)==="deal-create"||a.actionName==="ticket-create")&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:c("Pipeline:")}),l.jsxs("select",{onChange:m,name:"pipeline",value:a==null?void 0:a.pipeline,className:"btcd-paper-inp w-5",children:[l.jsx("option",{value:"",children:c("Select Pipeline")}),(k=a==null?void 0:a.default)==null?void 0:k.pipelines.map(({pipelineId:v,pipelineName:g})=>l.jsx("option",{value:v,children:g},v))]})]}),l.jsx("br",{}),l.jsx("br",{}),l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:c("Stage:")}),l.jsxs("select",{onChange:s,name:"stage",value:a==null?void 0:a.stage,className:"btcd-paper-inp w-5",children:[l.jsx("option",{value:"",children:c("Select Stage")}),(I=(E=a==null?void 0:a.stageTmp)==null?void 0:E[0])==null?void 0:I.map(({stageId:v,stageName:g})=>l.jsx("option",{value:v,children:g},v))]})]})]}),l.jsx("br",{}),((a==null?void 0:a.actionName)==="contact-create"||(a==null?void 0:a.pipeline)&&(a==null?void 0:a.stage))&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"mt-5",children:l.jsx("b",{className:"wdt-100",children:c("Field Map")})}),l.jsx("div",{className:"btcd-hr mt-1"}),l.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[l.jsx("div",{className:"txt-dp",children:l.jsx("b",{children:c("Form Fields")})}),l.jsx("div",{className:"txt-dp",children:l.jsx("b",{children:c("Hubspot Fields")})})]})]}),((a==null?void 0:a.actionName)==="contact-create"||(a==null?void 0:a.pipeline)&&(a==null?void 0:a.stage))&&(a==null?void 0:a.field_map.map((v,g)=>l.jsx(ie,{i:g,field:v,hubspotConf:a,formFields:e,setHubspotConf:i,setSnackbar:n,actionName:a==null?void 0:a.actionName,hubspotFields:F()},`rp-m-${g+9}`))),l.jsx("div",{className:"txt-center mt-2",style:{marginRight:85},children:l.jsx("button",{onClick:()=>X(a.field_map.length,a,i),className:"icn-btn sh-sm",type:"button",children:"+"})}),l.jsx("br",{}),l.jsx("br",{}),l.jsx("div",{className:"mt-4",children:l.jsx("b",{className:"wdt-100",children:c("Actions")})}),l.jsx("div",{className:"btcd-hr mt-1"}),l.jsx(se,{hubspotConf:a,setHubspotConf:i,formFields:e})]})}export{ve as H,je as c,ge as h};
