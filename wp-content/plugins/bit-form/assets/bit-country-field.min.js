var bit_country_field=function(){"use strict";return class{#t;#e;#s;#i;#n;#r;#l="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'/>";#o;#a;#h;#d;#c;#p="";#u=[];#m=!0;#y=!0;#C=!0;#b=!0;#E=!1;#g=!1;#f="";#I="Select a Country";#w="Search Country";#v="No Currency Found";#O=370;#S=30;#x;#L={};#A=[];#F={};#W={};#T="";#k="";#B=null;#H="";#N=[];#$;#P=!1;constructor(t,e){this.#M(e),this.#t="string"==typeof t?this.#x.querySelector(t):t,this.fieldKey=this.#k,this.init()}#M(t){this.#x=t.document||document,this.#L=t.window||window,this.#k=t.fieldKey,this.#f=t.defaultValue,this.#I=t.placeholder,this.#w=t.searchPlaceholder||"Search Country",this.#v=t.noCountryFoundText||"No Country Found",this.#S=t.rowHeight||30,this.#O=t.maxHeight||370,this.#m=t.selectedFlagImage,this.#y=t.selectedCountryClearable,this.#C=t.searchClearable,this.#b=t.optionFlagImage,this.#E=t.detectCountryByIp,this.#g=t.detectCountryByGeo,this.#T=t.assetsURL,this.#$=t.onChange,this.#F=t.attributes||{},this.#W=t.classNames||{},"string"==typeof t.options&&(t.options=this.#K(t.options)),this.#A=t.options.filter((t=>!t.hide)),this.#u=this.#A}init(){this.#e=this.#R(`.${this.fieldKey}-country-hidden-input`),this.#s=this.#R(`.${this.fieldKey}-dpd-wrp`),this.#i=this.#R(`.${this.fieldKey}-selected-country-img`),this.#n=this.#R(`.${this.fieldKey}-selected-country-lbl`),this.#r=this.#y?this.#R(`.${this.fieldKey}-inp-clr-btn`):{},this.#o=this.#R(`.${this.fieldKey}-option-search-wrp`),this.#a=this.#R(`.${this.fieldKey}-opt-search-input`),this.#h=this.#R(`.${this.fieldKey}-search-clear-btn`),this.#d=this.#R(`.${this.fieldKey}-option-wrp`),this.#c=this.#R(`.${this.fieldKey}-option-list`),this.setMenu({open:!1}),this.#E&&this.#V(),this.#g&&this.#D(),this.#f&&this.#U(),this.#G(),this.#z(),this.#L.observeElm(this.#e,"value",((t,e)=>{this.#_(t,e)})),this.#m||this.#i?.remove(),this.#C&&(this.#q(this.#a,"padding-right","35px"),this.#q(this.#h,"display","none"))}#K(t){const e=t.split("->");let s=this.#L;return e.forEach((t=>{s=s[t]})),s}#z(){this.#j(this.#s,"click",(t=>{this.#J(t)})),this.#j(this.#s,"keyup",(t=>{this.#J(t)})),this.#j(this.#t,"keydown",(t=>{this.#Q(t)})),this.#C&&this.#j(this.#h,"click",(()=>{this.searchOptions("")})),this.#j(this.#a,"keyup",(t=>{this.#X(t)}))}#U(){const t=this.#A.find((t=>{const e=this.#f;return!(t.i!==e)||(t.val?t.val===e:t.lbl===e)}));t&&this.setSelectedCountryItem(t.i)}#G(){const t=this.#e.name,e=decodeURIComponent(`${this.#x.URL}`.replace(/\+/g,"%20")).replace(new RegExp(`.*${t}=([^&]*).*|(.*)`),"$1");e&&this.#_("",e)}#R(t){return this.#t.querySelector(t)}#j(t,e,s){t.addEventListener(e,s),this.#N.push({selector:t,eventType:e,cb:s})}#V(){const{protocol:t}=this.#L.location;fetch(`${t}//www.cloudflare.com/cdn-cgi/trace`).then((t=>t.text())).then((t=>{const e=t.trim().split("\n").reduce(((t,e)=>{const[s,i]=e.split("=");return t[s]=i,t}),{});this.setSelectedCountryItem(e?.loc)}))}#D(){navigator.geolocation.getCurrentPosition((t=>{const{latitude:e,longitude:s}=t.coords,{protocol:i}=this.#L.location;fetch(`${"https:"===i?`${i}//secure`:`${i}//api`}.geonames.org/countryCodeJSON?username=bitcodezoho1&lat=${e}&lng=${s}`).then((t=>t.json())).then((t=>{this.setSelectedCountryItem(t.countryCode)}))}))}#Q(t){t.stopPropagation();const e=this.#x.activeElement;let s=null;if(this.#Y()){const i=Number(e.dataset.index||-1);if("ArrowDown"===t.key||!t.shiftKey&&"Tab"===t.key){if(t.preventDefault(),e===this.#a)s=this.#R(".option:not(.disabled-opt)");else if(e.classList.contains("option")){const t=this.#Z(i,"next"),e=this.#tt(t);e?s=e:t+1<this.#u.length&&(this.virtualOptionList?.scrollToIndex(t),setTimeout((()=>{const e=this.#tt(t);e&&e.focus()}),50))}}else if("ArrowUp"===t.key||t.shiftKey&&"Tab"===t.key){if(t.preventDefault(),e===this.#a)s=this.#s,this.#Y()&&this.setMenu({open:!1});else if(e.classList.contains("option")){const t=this.#Z(i,"previous"),e=this.#tt(t);e?s=e:t>0?(this.virtualOptionList?.scrollToIndex(t),setTimeout((()=>{const e=this.#tt(t);e&&e.focus()}),50)):e||(s=this.#a)}}else"Escape"===t.key&&this.setMenu({open:!1})}else if(t.key>="a"&&t.key<="z"){clearTimeout(this.#B),this.#H+=t.key,this.#B=setTimeout((()=>{this.#H=""}),300);const e=this.#A.find((t=>!t.disabled&&t.lbl.toLowerCase().startsWith(this.#H)));e&&this.setSelectedCountryItem(e.i)}else if("ArrowDown"===t.key||"ArrowUp"===t.key){t.preventDefault();const e=this.#et(),s="ArrowDown"===t.key?"next":"previous",i=this.#Z(e,s);i>-1&&i<this.#A.length&&(this.value=this.#A[i].val||this.#A[i].lbl,this.#st(this.#e,"blur"))}s&&s.focus()}#tt(t){return this.#R(`.${this.fieldKey}-option-list .option[data-index="${t}"]`)}#Z(t=-1,e){if("next"===e){const e=this.#A.length;for(let s=t+1;s<e;s+=1)if(!this.#A[s].disabled)return s}else if("previous"===e)for(let e=t-1;e>=0;e-=1)if(!this.#A[e].disabled)return e}#_(t,e){const s=this.#A.find((t=>t.i===e||t.val===e||t.lbl===e));s&&t!==e&&this.setSelectedCountryItem(s.i),"undefined"!=typeof bit_conditionals&&bit_conditionals({target:this.#e})}#it(t){t?.stopPropagation(),this.#p="",this.#m&&(this.#i.src=this.#l),this.#nt(this.#n,this.#I),this.#y&&this.#q(this.#r,"display","none"),this.#rt(this.#s,"aria-label","Selected country cleared"),this.#P||this.#s.focus(),this.setMenu({open:!1}),this.value="",this.#st(this.#e,"blur"),setTimeout((()=>{this.#rt(this.#s,"aria-label",this.#I)}),100)}#st(t,e){const s=new Event(e);t.dispatchEvent(s)}setSelectedCountryItem(t){if(this.#p=t,!this.#p)return;const e=this.#lt();e&&(this.#m&&this.#i&&(this.#i.src=`${this.#T}${e.img}`),this.#nt(this.#n,e.lbl),this.setMenu({open:!1}),this.value=e.val||e.lbl,this.#y&&(this.#q(this.#r,"display","grid"),this.#j(this.#r,"click",(t=>{this.#it(t)}))),this.#$&&this.#$(e.val||e.lbl),this.#rt(this.#s,"aria-label",`${e.lbl} selected`),this.#st(this.#e,"blur"),setTimeout((()=>{this.#rt(this.#s,"aria-label",e.lbl)}),100))}#et(){return this.#u.findIndex((t=>t.i===this.#p))}#lt(){return this.#A.find((t=>t.i===this.#p))}#ot(t){return this.#x.createElement(t)}#at(t,e){t.classList.add(e)}#nt(t,e){t.textContent=e}#rt(t,e,s){t?.setAttribute?.(e,s)}#q(t,e,s){t.style.setProperty(e,s,"important")}#ht(){if(!this.#Y())return;this.#dt();const t=this.#et(),e=this.#R(`.option[data-index="${t}"]`);e&&e.scrollIntoView({block:"nearest",inline:"nearest"})}#ct(t,e){e.trim().split(/\b\s+\b/g).forEach((e=>this.#at(t,e)))}#pt(t,e){const s=e.length;if(s)for(let i=0;i<s;i+=1)this.#rt(t,e[i].key,e[i].value)}#ut(){const t=this.#R(".option");if(!t)return;const e=this.#L.getComputedStyle(t),s=parseFloat(e.marginTop)+parseFloat(e.marginBottom),i=t.offsetHeight+s||0;i!==this.#S&&(this.#S=i,this.#c.innerHTML="",this.#dt())}#dt(){this.#c.innerHTML="";const t=this.#u.map(((t,e)=>{const s=this.#ot("li");if(this.#rt(s,"data-key",t.i),this.#rt(s,"data-index",e),"option"in this.#F){const t=this.#F.option;this.#pt(s,t)}if(this.#rt(s,"data-dev-option",this.fieldKey),!t.i)return this.#nt(s,t.lbl),this.#at(s,"opt-not-found"),s;if(this.#at(s,"option"),"option"in this.#W){const t=this.#W.option;t&&this.#ct(s,t)}const i=this.#ot("span");if(this.#at(i,"opt-lbl-wrp"),"opt-lbl-wrp"in this.#W){const t=this.#W["opt-lbl-wrp"];t&&this.#ct(i,t)}if("opt-lbl-wrp"in this.#F){const t=this.#F["opt-lbl-wrp"];this.#pt(i,t)}if(this.#b){const e=this.#ot("img");if("opt-icn"in this.#F){const t=this.#F["opt-icn"];t&&this.#pt(e,t)}if(this.#at(e,"opt-icn"),"opt-icn"in this.#W){const t=this.#W["opt-icn"];t&&this.#ct(e,t)}e.src=`${this.#T}${t.img}`,e.alt=`${t.lbl} flag image`,e.loading="lazy",this.#rt(e,"aria-hidden",!0),i.append(e)}const n=this.#ot("span");if("opt-lbl"in this.#F){const t=this.#F["opt-lbl"];this.#pt(n,t)}if(this.#at(n,"opt-lbl"),"opt-lbl"in this.#W){const t=this.#W["opt-lbl"];t&&this.#ct(n,t)}return this.#nt(n,t.lbl),i.append(n),s.tabIndex=this.#Y()?"0":"-1",this.#rt(s,"role","option"),this.#rt(s,"aria-posinset",e+1),this.#rt(s,"aria-setsize",this.#u.length),this.#j(s,"click",(t=>{this.setSelectedCountryItem(t.currentTarget.dataset.key)})),this.#j(s,"keyup",(t=>{"Enter"===t.key&&this.setSelectedCountryItem(t.currentTarget.dataset.key)})),t.disabled&&this.#at(s,"disabled-opt"),s.append(i),this.#p===t.i?(this.#at(s,"selected-opt"),this.#rt(s,"aria-selected",!0)):this.#rt(s,"aria-selected",!1),s}));this.#c.append(...t)}#X(t){if(t.stopPropagation(),"Enter"===t.key&&this.#u.length){const t=this.#u?.[0].i;t&&(this.setSelectedCountryItem(t),this.searchOptions(""))}else this.searchOptions(t.target.value)}searchOptions(t){this.#mt(t);let e=[];t?(e=this.#A.filter((e=>e.lbl.toLowerCase().includes(t.toLowerCase()))),e.length||(e=[{i:0,lbl:this.#v}]),this.#u=e,this.#C&&this.#q(this.#h,"display","grid")):(this.#u=this.#A,this.#C&&this.#q(this.#h,"display","none")),this.#ht()}#mt(t){this.#a.value=t}#yt(t){this.#t.contains(t.target)||this.setMenu({open:!1})}#Y(){return this.#t.classList.contains("menu-open")}#Ct(){const t=this.#L,e=this.#s.getBoundingClientRect(),s=e.top,i=t.innerHeight-e.bottom;i<s&&i<this.#O?(this.#q(this.#t,"flex-direction","column-reverse"),this.#q(this.#t,"bottom","0%")):(this.#q(this.#t,"flex-direction","column"),this.#q(this.#t,"bottom","auto"))}setMenu({open:t}){this.#q(this.#d,"max-height",`${t?this.#O:0}px`),t?(this.#Ct(),this.#t.classList.add("menu-open"),this.#j(this.#x,"click",(t=>this.#yt(t))),this.#a.tabIndex="0",this.#h.tabIndex="0",this.#s.setAttribute("aria-expanded","true"),this.#rt(this.#c,"aria-hidden",!1),this.#rt(this.#a,"aria-hidden",!1),this.#ht()):(this.#t.classList.remove("menu-open"),this.#x.removeEventListener("click",this.#yt),setTimeout((()=>{this.searchOptions("")}),100),this.#a.blur(),this.#a.tabIndex="-1",this.#h.tabIndex="-1",this.#s.setAttribute("aria-expanded","false"),this.#rt(this.#c,"aria-hidden",!0),this.#rt(this.#a,"aria-hidden",!0))}#J(t){"Space"===t.code&&(this.#a.focus(),this.setMenu({open:!0})),"click"===t.type&&(this.#Y()?this.setMenu({open:!1}):(this.#a.focus(),this.setMenu({open:!0})))}set disabled(t){"true"===String(t).toLowerCase()?(this.#t.classList.add("disabled"),this.#e.disabled=!0,this.#y&&this.#rt(this.#r,"tabindex","-1"),this.#rt(this.#s,"aria-label","Country Field disabled"),this.#rt(this.#s,"tabindex","-1"),this.setMenu({open:!1}),this.#N.forEach((({selector:t,eventType:e,cb:s})=>{t.removeEventListener(e,s)}))):"false"===String(t).toLowerCase()&&(this.#t.classList.remove("disabled"),this.#e.removeAttribute("disabled"),this.#rt(this.#s,"tabindex","0"),this.#y&&this.#rt(this.#r,"tabindex","0"),this.#rt(this.#s,"aria-label",this.#I),this.#z())}get disabled(){return this.#e.disabled}set readonly(t){"true"===String(t).toLowerCase()?(this.#t.classList.add("disabled"),this.#e.readOnly=!0,this.#rt(this.#s,"tabindex","-1"),this.#y&&this.#rt(this.#r,"tabindex","-1"),this.setMenu({open:!1})):"false"===String(t).toLowerCase()&&(this.#t.classList.remove("disabled"),this.#e.removeAttribute("readonly"),this.#y&&this.#rt(this.#s,"tabindex","0"),this.#rt(this.#r,"tabindex","0"))}get readonly(){return this.#e.readOnly}set value(t){this.#e.value=t,this.#rt(this.#e,"value",t)}get value(){const t=this.#lt();return t.val||t.lbl}#bt(){this.#N.forEach((({selector:t,eventType:e,cb:s})=>{t.removeEventListener(e,s)}))}destroy(){this.#c.innerHTML="",this.value="",this.#bt()}reset(t){this.#P=!0,this.#it(),this.destroy(),this.init(),this.setSelectedCountryItem(t),this.#P=!1}}}();
