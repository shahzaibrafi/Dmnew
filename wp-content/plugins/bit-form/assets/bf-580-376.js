var M=Object.defineProperty;var N=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var v=(l,r,e)=>r in l?M(l,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[r]=e,n=(l,r)=>{for(var e in r||(r={}))$.call(r,e)&&v(l,e,r[e]);if(N)for(var e of N(r))L.call(r,e)&&v(l,e,r[e]);return l};import{c as y,_ as c,u as V,j as s,y as k,$ as q,o as I}from"./main-677.js";import{u as R}from"./bf-743-127.js";import{d as O}from"./bf-67-72.js";import{S as D}from"./bf-648-122.js";import{M as T}from"./bf-878-130.js";const K=(l,r,e,a,i)=>{a(!0),y({},"bitforms_refresh_news_letter").then(d=>{if(d&&d.success){const u=n({},r);u.default||(u.default={}),d.data.newsletterList&&(u.default.newsletterList=d.data.newsletterList),i({show:!0,msg:c("Newsletter list refreshed")}),e(n({},u))}else d&&d.data&&d.data.data||!d.success&&typeof d.data=="string"?i({show:!0,msg:`${c("Newsletter list refresh failed Cause:")}${d.data.data||d.data}. ${c("please try again")}`}):i({show:!0,msg:c("Newsletter list refresh failed. please try again")});a(!1)}).catch(()=>a(!1))},z=(l,r,e,a)=>{y({},"bitforms_mail_poet_list_headers").then(i=>{if(i&&i.success){const d=n({},l);if(i.data.mailPoetFields){d.default.fields=i.data.mailPoetFields;const{fields:u}=d.default;d.field_map=Object.values(u).filter(x=>x.required).map(x=>({formField:"",mailPoetField:x.id,required:!0})),a({show:!0,msg:c("Mailpoet fields refreshed")})}else a({show:!0,msg:c("No Mailpoet fields found. Try changing the header row number or try again")});i.data.tokenDetails&&(d.tokenDetails=i.data.tokenDetails),r(n({},d))}else a({show:!0,msg:c("Mailpoet fields refresh failed. please try again")});e(!1)}).catch(()=>e(!1))},Q=(l,r,e)=>{const a=n({},r);a.name=l.target.value,e(n({},a))},U=l=>!((l!=null&&l.field_map?l.field_map.filter(e=>!e.formField&&e.mailPoetField&&e.required):[]).length>0);function A({i:l,formFields:r,field:e,mailPoetConf:a,setMailPoetConf:i}){var o,g,w,F;const d=e.required,u=((o=a==null?void 0:a.default)==null?void 0:o.fields)&&Object.values((g=a==null?void 0:a.default)==null?void 0:g.fields).filter(t=>t.required===""),x=V(q),{isPro:b}=x,p=t=>{const h=n({},a);h.field_map.splice(t,0,{}),i(h)},m=t=>{const h=n({},a);h.field_map.length>1&&h.field_map.splice(t,1),i(h)},f=(t,h)=>{const j=n({},a);j.field_map[h][t.target.name]=t.target.value,t.target.value==="custom"&&(j.field_map[h].customValue=""),i(j)},_=(t,h)=>{const j=n({},a);j.field_map[h].customValue=t.target.value,i(j)};return s.jsxs("div",{className:"flx mt-2 mr-1",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:t=>f(t,l),children:[s.jsx("option",{value:"",children:c("Select Field")}),s.jsx("optgroup",{label:"Form Fields",children:r.map(t=>t.type!=="file-up"&&s.jsx("option",{value:t.key,children:t.name},`ff-zhcrm-${t.key}`))}),s.jsx("option",{value:"custom",children:c("Custom...")}),s.jsx("optgroup",{label:`General Smart Codes ${b?"":"(PRO)"}`,children:b&&((w=D)==null?void 0:w.map(t=>s.jsx("option",{value:t.name,children:t.label},`ff-rm-${t.name}`)))})]}),e.formField==="custom"&&s.jsx(T,{onChange:t=>_(t,l),label:c("Custom Value"),className:"mr-2",type:"text",value:e.customValue,placeholder:c("Custom Value")}),s.jsxs("select",{className:"btcd-paper-inp",name:"mailPoetField",value:e.mailPoetField,onChange:t=>f(t,l),disabled:d,children:[s.jsx("option",{value:"",children:c("Select Field")}),d?((F=a==null?void 0:a.default)==null?void 0:F.fields)&&Object.values(a.default.fields).map(t=>s.jsx("option",{value:t.id,children:t.name},`${t.id}-1`)):u&&u.map(t=>s.jsx("option",{value:t.id,children:t.name},`${t.id}-1`))]})]}),!d&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>p(l),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),s.jsx("button",{onClick:()=>m(l),className:"icn-btn sh-sm ml-2",type:"button","aria-label":"btn",children:s.jsx(k,{})})]})]})}function W({formID:l,formFields:r,mailPoetConf:e,setMailPoetConf:a,isLoading:i,setisLoading:d,setSnackbar:u}){var b;const x=p=>{const m=n({},e);p?(m.lists=p?p.split(","):[],z(m,a,d,u)):delete m.lists,a(n({},m))};return s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsxs("div",{className:"flx",children:[s.jsx("b",{className:"wdt-200 d-in-b",children:c("List: ")}),s.jsx(R,{defaultValue:e==null?void 0:e.lists,className:"btcd-paper-drpdwn w-6",options:((b=e==null?void 0:e.default)==null?void 0:b.newsletterList)&&Object.keys(e.default.newsletterList).map(p=>({label:e.default.newsletterList[p].newsletterName,value:e.default.newsletterList[p].newsletterId})),onChange:p=>x(p)}),s.jsx("button",{onClick:()=>x(l),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${c("Refresh MailPoet List")}'`},type:"button",disabled:i,children:"â†»"})]}),i&&s.jsx(I,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),(e==null?void 0:e.lists)&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mt-4",children:s.jsx("b",{className:"wdt-100",children:c("Map Fields")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-1",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:c("Form Fields")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:c("MailPoet Fields")})})]}),e.field_map.map((p,m)=>s.jsx(A,{i:m,field:p,mailPoetConf:e,formFields:r,setMailPoetConf:a},`mailpoet-m-${m+9}`)),s.jsx("div",{className:"txt-center  mt-2",style:{marginRight:85},children:s.jsx("button",{onClick:()=>O(e.field_map.length,e,a),className:"icn-btn sh-sm",type:"button",children:"+"})}),s.jsx("br",{}),s.jsx("br",{})]})]})}export{W as M,U as c,Q as h,K as r};
