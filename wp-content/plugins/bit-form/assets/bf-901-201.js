var z=Object.defineProperty;var v=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var b=(d,r,a)=>r in d?z(d,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):d[r]=a,m=(d,r)=>{for(var a in r||(r={}))A.call(r,a)&&b(d,a,r[a]);if(v)for(var a of v(r))D.call(r,a)&&b(d,a,r[a]);return d};import{r as C,a as U,j as e,_ as n,y as V,aL as w,b as y,L as S,Q as W,B as I,c as M}from"./main-677.js";/* empty css          */import{u as G}from"./bf-743-127.js";import{B as J}from"./bf-8-69.js";import{B as x}from"./bf-183-126.js";import"./bf-610-73.js";function se({formID:d,formFields:r,webHooks:a,setWebHooks:h,step:K,setstep:T,setSnackbar:o,create:$,isInfo:i}){var g;const j=s=>s==null?void 0:s.match(/(\?|&)([^=]+)=([^&]+|)/gi),[P,p]=C.useState(!1),E=["GET","POST","PUT","PATCH","OPTION","DELETE","TRACE","CONNECT"],{css:L}=U(),N=C.useRef(null),_=s=>{try{return JSON.stringify(s,null,2)}catch(t){return s}},k=s=>{p(!0),M({hookDetails:s},"bitforms_test_webhook").then(t=>{if(t&&t.success)N.current.innerHTML=`<pre>${_(t.data.response)}</pre>`,o({show:!0,msg:n(t.data.msg)}),p(!1);else if(t&&t.data){const l=typeof t.data=="string"?t.data:"Unknown error";o({show:!0,msg:`${l}. ${n("please try again")}`}),p(!1)}else o({show:!0,msg:n("Webhook tests failed. please try again")}),p(!1)})},f=(s,t,l)=>{const c=m({},a);t!==""?s==="key"?c.url=c.url.replace(l,`${l.charAt(0)}${t}=${l.split("=")[1]}`):c.url=c.url.replace(l,`${l.split("=")[0]}=${t}`):l.match(/\?/g)===null?c.url=c.url.replace(l,""):c.url=c.url.replace(`${l}&`,"?"),h(c)},u=s=>{const t=m({},a);t[s.target.name]=s.target.value,h(m({},t))},B=(s,t)=>{const l=m({},a),c=t.split("=");c[1]=s,l.url=l.url.replace(t,c.join("=")),h(l)},R=()=>{const s=m({},a);s.url.match(/\?/g)!==null?s.url+="&key=value":s.url+="?key=value",h(s)},F=s=>{const t=m({},a);t.url=t.url.replace(s,""),h(t)},O=()=>{setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),T(2)};return e.jsxs("div",{style:{width:i&&900},children:[e.jsx("div",{className:"flx ",children:e.jsxs("div",{className:"w-7 mr-2 mb-4 mt-2",children:[e.jsx("div",{className:"f-m",children:n("Integration name")}),e.jsx("input",{name:"name",onChange:s=>u(s),className:"btcd-paper-inp mt-1",type:"text",value:a.name,disabled:i})]})}),e.jsxs("div",{className:"flx flx-start",children:[e.jsxs("div",{className:"w-7",children:[e.jsx("div",{className:"f-m",children:n("Link:")}),e.jsx("input",{name:"url",onChange:s=>u(s),className:"btcd-paper-inp mt-1",type:"text",value:a.url,disabled:i}),(a==null?void 0:a.apiConsole)&&e.jsxs("small",{className:"d-blk mt-2",children:[n("To got Webhook , Please Visit")," ",e.jsx("a",{className:"btcd-link",href:a.apiConsole,target:"_blank",rel:"noreferrer",children:n(`${a.type} Dashboard`)})]})]}),e.jsxs("div",{className:"w-3 px-1",children:[e.jsx("div",{className:"f-m",children:n("Method:")}),e.jsx("select",{name:"method",onChange:s=>u(s),defaultValue:a.method,className:"btcd-paper-inp mt-1",disabled:i,children:E.map((s,t)=>e.jsx("option",{value:s,children:s},`method-${t*2}`))})]})]}),e.jsx("br",{}),e.jsx("div",{className:"f-m",children:n("Add Url Parameter: (optional)")}),e.jsx("div",{className:"btcd-param-t-wrp mt-1",children:e.jsxs("div",{className:"btcd-param-t",children:[e.jsxs("div",{className:"tr",children:[e.jsx("div",{className:"td",children:n("Key")}),e.jsx("div",{className:"td",children:n("Value")})]}),j(a.url)!==null&&((g=j(a.url))==null?void 0:g.map((s,t)=>e.jsxs("div",{className:"tr",children:[e.jsx("div",{className:"td",children:e.jsx("input",{className:"btcd-paper-inp p-i-sm",onChange:l=>f("key",l.target.value,s),type:"text",value:s.split("=")[0].substr(1),disabled:i})}),e.jsx("div",{className:"td",children:e.jsx("input",{className:"btcd-paper-inp p-i-sm",onChange:l=>f("val",l.target.value,s),type:"text",value:s.split("=")[1],disabled:i})}),!i&&e.jsxs("div",{className:"flx p-atn",children:[e.jsx(x,{onClick:()=>F(s),icn:!0,children:e.jsx(V,{size:16})}),e.jsx(G,{options:r.map(l=>({label:l.name,value:`\${${l.key}}`})),className:"btcd-paper-drpdwn wdt-200 ml-2",singleSelect:!0,onChange:l=>B(l,s),defaultValue:s.split("=")[1]})]})]},`fu-1${t*3}`))),!i&&e.jsx(x,{onClick:()=>R(),className:"add-pram",icn:!0,children:e.jsx(w,{size:"14",className:"icn-rotate-45"})})]})}),!i&&e.jsxs(e.Fragment,{children:[e.jsxs(x,{onClick:()=>k(a),className:L(y.btn,y.btn_blue_otln),children:[n("Test Webhook"),P&&e.jsx(S,{size:14,clr:"#022217",className:"ml-2"}),e.jsx(W,{size:18,className:"ml-1"})]}),e.jsxs("div",{className:"wh-resp-box",children:[e.jsx("div",{className:"f-m wh-resp-box-title",children:n("Response:")}),e.jsx("div",{className:"wh-resp-box-content",ref:N,children:"Test Webhook to see the response."})]})]}),e.jsxs("small",{className:"d-blk mt-2 mb-2",children:[n("Try our free webhook test website: "),e.jsx("a",{className:"btcd-link",href:"https://webhook.is",target:"_blank",rel:"noreferrer",children:"https://webhook.is"})]}),$&&e.jsx(e.Fragment,{children:e.jsxs(I,{variant:"success",onClick:()=>O(),type:"button",children:[n("Next"),e.jsx(J,{className:"ml-1 rev-icn"})]})})]})}export{se as default};
