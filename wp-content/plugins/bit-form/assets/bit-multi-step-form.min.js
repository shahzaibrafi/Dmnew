var bit_multi_step_form=function(){"use strict";class t{#t=null;#e=[];#s=[];#r=[];#i=1;#n=1;#a=!0;#h=!0;#o=!0;#l=!0;#d=!0;#p="";#c=0;#u=[];constructor(t,e){this.#t="string"==typeof t?document.querySelector(t):t,t&&(this.#S(e),this.init())}init(){this.#e=Array.from(this.#f(".next-step-btn")),this.#s=Array.from(this.#f(".prev-step-btn")),this.#m(),this.#v(),this.#g(),this.#b()}#m(){const t=this.#E(1),e=this.#y(".prev-step-btn",t);e&&(e.disabled=!0,e.classList.add("v-hide"),this.#s=this.#s.filter((t=>!1===t.isEqualNode(e))));const s=this.#f(`._frm-b${this.#c}-stp-cntnt[data-step]`).length,r=this.#E(s),i=this.#y(".next-step-btn",r);i&&(i.disabled=!0,i.classList.add("v-hide"),this.#e=this.#e.filter((t=>!1===t.isEqualNode(i))))}#I(t){t.preventDefault();const e=t.target.closest(`._frm-b${this.#c}-stp-hdr`);if(e.classList.contains("disabled"))return;const s=Number(e.getAttribute("data-step"));this.#i!==s&&(this.#h&&s>this.#i&&this.#u.push(this.#i),this.#i=s,this.#C(s))}#b(){if(!this.#l)return;const t=this.#f(`._frm-b${this.#c}-stp-hdr`);t&&t.forEach((t=>{const e=this.#y(`._frm-b${this.#c}-stp-icn-cntn`,t);e&&this.#w(e,"click",(t=>{this.#I(t)}));const s=this.#y(`._frm-b${this.#c}-stp-hdr-lbl`,t);s&&this.#w(s,"click",(t=>{this.#I(t)}))}))}#S(t){"defaultStep"in t&&(this.#n=t.defaultStep),"validateOnStepChange"in t&&(this.#a=t.validateOnStepChange),"maintainStepHistory"in t&&(this.#h=t.maintainStepHistory),"saveProgress"in t&&(this.#o=t.saveProgress),"stepHeaderSwitchable"in t&&(this.#l=t.stepHeaderSwitchable),"showPercentage"in t&&(this.#d=t.showPercentage),this.#p=t.contentId,this.#c=this.#L()}#y(t,e){return(e||this.#t).querySelector(t)}#f(t,e){return(e||this.#t).querySelectorAll(t)}#w(t,e,s){t.addEventListener(e,s),this.#r.push({elm:t,event:e,handler:s})}#E(t=this.#i){return this.#y(`._frm-b${this.#c}-stp-cntnt[data-step="${t}"]`)}#$(){if(!this.#E(this.#i+1))return!1}#_(){if(!this.#E(this.#i-1))return!1}#L(){return Number(this.#p.split("_")[1])}#H(t){const e=window.bf_globals[this.#p].layout[t-1];if(!e)return;const s=e.layout.lg[0].i,r=this.#y(`.btcd-fld-itm.${s}`);setTimeout((()=>{r&&scrollToElm(r,{immediate:!0})}),100)}#B(t){this.#f(`._frm-b${this.#c}-stp-hdr`).forEach((e=>{e.classList.remove("completed","active");const s=Number(e.getAttribute("data-step"));s<t?e.classList.add("completed"):s===t&&e.classList.add("active")}))}#P(t){const e=this.#f(`._frm-b${this.#c}-stp-cntnt:not([data-step="${t}"])`),s=this.#y(`._frm-b${this.#c}-progress-fill`),r=e.length+1,i=Math.round((t-1)/r*100);s&&(s.style.width=`${i}%`),this.#d&&s&&(s.textContent=`${i}%`)}#A(t){const e=this.#y(`._frm-b${this.#c}-stp-cntnt[data-step="${t}"]`);e&&(e.classList.remove("deactive"),this.#f(`._frm-b${this.#c}-stp-cntnt:not([data-step="${t}"])`).forEach((t=>{t.classList.add("deactive")})))}#C(t){this.#A(t),this.#H(t),this.#B(t),this.#P(t)}#x(t){const e=this.#E();if(!e)return;const s=this.#y(".next-step-btn",e);if(!s)return;const r=this.#y(".bf-spinner",s);t?(s.disabled=!0,r.classList.remove("d-none")):(s.removeAttribute("disabled"),r.classList.add("d-none"))}async#W(){this.#x(!0);try{"undefined"!=typeof isFormValidatedWithoutError&&await isFormValidatedWithoutError(this.#p,{step:this.#i})}catch(t){return Promise.resolve(!1)}finally{this.#x(!1)}return Promise.resolve(!0)}#F(){this.#o&&"undefined"!=typeof saveFormProgress&&saveFormProgress(this.#p)}#v(){this.#e.length&&this.#e.forEach((t=>{this.#w(t,"click",(async()=>{if(this.#a&&!await this.#W())return;this.#h&&this.#u.push(this.#i),this.#i+=1;const t=this.#y(`._frm-b${this.#c}-stp-hdr[data-step="${this.#i}"]`);t&&t.classList.remove("disabled"),this.#C(this.#i),this.#F()}))}))}get step(){return this.#i}set step(t){const e=Number(t);this.#E(e)&&(this.#h&&this.#i<e&&this.#u.push(this.#i),this.#i=e,this.#C(this.#i))}#g(){this.#s.length&&this.#s.forEach((t=>{this.#w(t,"click",(()=>{this.#h?this.#i=this.#u.pop():this.#i>0&&(this.#i-=1),this.#C(this.#i)}))}))}destroy(){}#N(){this.#r.forEach((({elm:t,event:e,handler:s})=>{t.removeEventListener(e,s)}))}reset(){if(this.step=this.#n||1,this.#N(),this.#a){const t=this.#f(`._frm-b${this.#c}-stp-hdr:not([data-step="1"])`);t&&t.forEach((t=>t.classList.add("disabled")))}this.init()}}return function(e=null){(e?[e]:Object.keys(window?.bf_globals||{})).forEach((e=>{const s=window.bf_globals[e],r=s.formInfo?.multiStepSettings;if(r){const{formId:i}=s,n=bfSelect(`#form-${e}`),a=bfSelect(`._frm-b${i}-stp-cntnr`,n);s.inits.multi_step_form=new t(a,{contentId:e,...r})}}))}}();
